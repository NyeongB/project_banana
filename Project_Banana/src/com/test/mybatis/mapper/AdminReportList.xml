<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  
<mapper namespace="com.banana.admin.IAdminReportListDAO">
	
	<select id="list" resultType="com.banana.admin.AdminReportListDTO">
	 SELECT  * FROM VIEW_REPORT_LIST
	</select>	
	
          <!-- 
          SELECT (SELECT ID FROM JOIN J WHERE J.B_USER_CODE = RP.B_USER_CODE) AS id1, '게시물' AS type, PRT.POST_REPORT_TYPE AS rType,RP.CONTENT AS content, R.REPORT_DATE AS sdate
          , J.ID AS id2
          FROM R_POST_REPORT R JOIN JOIN J
          ON R.B_USER_CODE = J.B_USER_CODE
          JOIN R_POST RP
          ON RP.R_POST_CODE = R.R_POST_CODE
          JOIN POST_REPORT_TYPE PRT
          ON PRT.POST_REPORT_TYPE_CODE = R.POST_REPORT_TYPE_CODE
          UNION
          SELECT (SELECT ID FROM JOIN J WHERE J.B_USER_CODE = RP.B_USER_CODE) AS id1, '게시물' AS type, PRT.POST_REPORT_TYPE AS rType,RP.CONTENT AS content, R.SDATE AS sdate
          , J.ID AS id2
          FROM G_POST_REPORT R JOIN JOIN J
          ON R.B_USER_CODE = J.B_USER_CODE
          JOIN G_POST RP
          ON RP.G_POST_CODE = R.G_POST_CODE
          JOIN POST_REPORT_TYPE PRT
          ON PRT.POST_REPORT_TYPE_CODE = R.POST_REPORT_TYPE_CODE
          UNION
          SELECT (SELECT ID FROM JOIN J WHERE J.B_USER_CODE = RP.B_USER_CODE) AS id1, '게시물' AS type, PRT.POST_REPORT_TYPE AS rType,RP.CONTENT AS content, R.SDATE AS sdate
          , J.ID AS id2
          FROM J_POST_REPORT R JOIN JOIN J
          ON R.B_USER_CODE = J.B_USER_CODE
          JOIN J_POST RP
          ON RP.J_POST_CODE = R.J_POST_CODE
          JOIN POST_REPORT_TYPE PRT
          ON PRT.POST_REPORT_TYPE_CODE = R.POST_REPORT_TYPE_CODE
          UNION
          SELECT (SELECT ID FROM JOIN J WHERE J.B_USER_CODE = RP.B_USER_CODE) AS id1, '게시물' AS type, PRT.POST_REPORT_TYPE AS rType,RP.CONTENT AS content, R.SDATE AS sdate
          , J.ID AS id2
          FROM RR_REQ_REPORT R JOIN JOIN J
          ON R.B_USER_CODE = J.B_USER_CODE
          JOIN RR_REQ RP
          ON RP.RR_REQ_CODE = R.RR_REQ_CODE
          JOIN POST_REPORT_TYPE PRT
          ON PRT.POST_REPORT_TYPE_CODE = R.POST_REPORT_TYPE_CODE
          UNION
          SELECT (SELECT ID FROM JOIN J WHERE J.B_USER_CODE = RP.B_USER_CODE) AS id1, '게시물' AS type, PRT.POST_REPORT_TYPE AS rType,'역렌트 제공 게시물 신고' AS content, R.SDATE AS sdate
          , J.ID AS id2
          FROM RR_OFFER_REPORT R JOIN JOIN J
          ON R.B_USER_CODE = J.B_USER_CODE
          JOIN RR_OFFER RP
          ON RP.RR_OFFER_CODE = R.RR_OFER_CODE
          JOIN POST_REPORT_TYPE PRT
          ON PRT.POST_REPORT_TYPE_CODE = R.POST_REPORT_TYPE_CODE  
          UNION
           SELECT (SELECT ID FROM JOIN J WHERE J.B_USER_CODE = R.B_USER_CODE)  AS id1,'댓글' AS "접수 유형", RRT.REPLY_REPORT_TYPE AS "신고유형", R.REPLY AS content, RR.SDATE AS sdate, J.ID AS id2 
           FROM	J_REPLY_REPORT RR 	JOIN J_REPLY R
           ON RR.J_REPLY_CODE = R.J_REPLY_CODE
           JOIN REPLY_REPORT_TYPE RRT
           ON RR.REPLY_REPORT_TYPE_CODE = RRT.REPLY_REPORT_TYPE_CODE
           JOIN JOIN J
           ON J.B_USER_CODE = RR.B_USER_CODE	          
           UNION
           SELECT (SELECT ID FROM JOIN J WHERE J.B_USER_CODE = R.B_USER_CODE)  AS id1,'댓글' AS "접수 유형", RRT.REPLY_REPORT_TYPE AS "신고유형", R.REPLY AS content, RR.SDATE AS sdate, J.ID AS id2 
           FROM	G_REPLY_REPORT RR 	JOIN G_REPLY R
           ON RR.G_REPLY_CODE = R.G_REPLY_CODE
           JOIN REPLY_REPORT_TYPE RRT
           ON RR.REPLY_REPORT_TYPE_CODE = RRT.REPLY_REPORT_TYPE_CODE
           JOIN JOIN J
           ON J.B_USER_CODE = RR.B_USER_CODE	          
            UNION
           SELECT (SELECT ID FROM JOIN J WHERE J.B_USER_CODE = R.B_USER_CODE)  AS id1,'댓글' AS "접수 유형", RRT.REPLY_REPORT_TYPE AS "신고유형", R.REPLY AS content, RR.SDATE AS sdate, J.ID AS id2 
           FROM	R_REPLY_REPORT RR 	JOIN R_REPLY R
           ON RR.R_REPLY_CODE = R.R_REPLY_CODE
           JOIN REPLY_REPORT_TYPE RRT
           ON RR.REPLY_REPORT_TYPE_CODE = RRT.REPLY_REPORT_TYPE_CODE
           JOIN JOIN J
           ON J.B_USER_CODE = RR.B_USER_CODE  
           UNION
           SELECT (SELECT ID FROM JOIN J WHERE J.B_USER_CODE = R.B_USER_CODE)  AS id1,'댓글' AS "접수 유형", RRT.REPLY_REPORT_TYPE AS "신고유형", R.REPLY AS content, RR.SDATE AS sdate, J.ID AS id2 
           FROM	RR_REPLY_REPORT RR 	JOIN RR_REPLY R
           ON RR.RR_REPLY_CODE = R.RR_REPLY_CODE
           JOIN REPLY_REPORT_TYPE RRT
           ON RR.REPLY_REPORT_TYPE_CODE = RRT.REPLY_REPORT_TYPE_CODE
           JOIN JOIN J
           ON J.B_USER_CODE = RR.B_USER_CODE;	   
           -->
	<select id="list2" resultType="com.banana.my.UserMyGiveReportListDTO">
	<!-- ID1 신고당한사람 ,ID2 신고한사람  -->
	SELECT DEAL_REPORT_CODE, DEAL_REPORT_TYPE, CONTENT, TITLE,SDATE,PROGRESS, TYPE, REPORTED, REPORTER FROM VIEW_MY_REPORT
	</select>	
	
	
	<!-- SELECT CASE WHEN R.DEAL_REPORTER_TYPE_CODE ='DREPO3' THEN (SELECT ID FROM JOIN WHERE B_USER_CODE = P.B_USER_CODE)
            ELSE (SELECT ID FROM JOIN WHERE B_USER_CODE = A.B_USER_CODE)
            END AS ID1,
            CASE WHEN R.DEAL_REPORTER_TYPE_CODE ='DREPO4' THEN (SELECT ID FROM JOIN WHERE B_USER_CODE = P.B_USER_CODE)
            ELSE (SELECT ID FROM JOIN WHERE B_USER_CODE = A.B_USER_CODE)
            END AS ID2 
            , '공통협력구매' AS TYPE, D.G_DEAL_REPORT_TYPE AS RTYPE
            , R.CONTENT AS CONTENT, R.SDATE  
            FROM G_DEAL_REPORT	 R JOIN G_SUCCESS S
            ON R.G_SUCCESS_CODE = S.G_SUCCESS_CODE
            JOIN G_POST P 
            ON P.G_POST_CODE = S.G_POST_CODE
            JOIN G_APPLY A
            ON A.G_APPLY_CODE = R.G_APPLY_CODE    
            JOIN G_DEAL_REPORT_TYPE D
            ON D.G_DEAL_REPORT_TYPE_CODE = R.G_DEAL_REPORT_TYPE_CODE
            UNION
             SELECT CASE WHEN R.DEAL_REPORTER_TYPE_CODE ='DREPO2' THEN (SELECT ID FROM JOIN WHERE B_USER_CODE = P.B_USER_CODE)
            ELSE (SELECT ID FROM JOIN WHERE B_USER_CODE = A.B_USER_CODE)
            END AS ID1,CASE WHEN R.DEAL_REPORTER_TYPE_CODE ='DREPO1' THEN (SELECT ID FROM JOIN WHERE B_USER_CODE = P.B_USER_CODE)
            ELSE (SELECT ID FROM JOIN WHERE B_USER_CODE = A.B_USER_CODE)
            END AS ID2 
            , '렌트거래' AS TYPE, D.R_DEAL_REPORT_TYPE AS RTYPE
            , R.CONTENT AS CONTENT, R.SDATE  
            FROM R_DEAL_REPORT R JOIN R_SUCCESS S
            ON R.R_SUCCESS_CODE = S.R_SUCCESS_CODE
            JOIN R_APPLY A
            ON S.R_APPLY_CODE = A.R_APPLY_CODE
            JOIN R_POST P 
            ON A.R_POST_CODE = P.R_POST_CODE
            JOIN R_DEAL_REPORT_TYPE D
            ON D.R_DEAL_REPORT_TYPE_CODE = R.DEAL_REPORTER_TYPE_CODE; -->
</mapper>  

