<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  
<mapper namespace="com.banana.groupbuying.IGPostDAO">
	
	<!--대분류 카테고리 선택  -->
	<select id="cateList" resultType="com.banana.groupbuying.GCateDTO">
	SELECT G_CATE_BCODE, CATE_NAME,G_CATE_CODE
	FROM G_CATE
	WHERE G_CATE_BCODE = #{g_cate_bcode} AND G_CATE_MCODE IS NULL
	</select>
	
	<!--소분류 카테고리 선택 -->
	<select id="cateMList" resultType="com.banana.groupbuying.GCateDTO">
	SELECT G_CATE_CODE,CATE_NAME
	FROM G_CATE
	WHERE G_CATE_BCODE = #{g_cate_bcode} AND G_CATE_MCODE = #{g_cate_code} 	
	</select>
	
	<!--공동구매 메인페이지에서 새로올라운 게시물  -->
	<select id="gNewList" resultType="com.banana.groupbuying.GPostDTO">
		SELECT TITLE,DIS_COST,L.LOC_NAME,P.PHOTO,G.G_POST_CODE
		FROM G_POST G  LEFT JOIN LOC L
		ON G.LOC_CODE = L.LOC_CODE
		        LEFT JOIN G_PHOTO P
		ON G.G_POST_CODE = P.G_POST_CODE
		ORDER BY WDATE DESC
	</select>
	
	<!--관심카테고리 기반 추천 게시물  -->
	<select id="gCateList" resultType="com.banana.groupbuying.GPostDTO">
		SELECT TITLE,DIS_COST,L.LOC_NAME,P.PHOTO,G.G_POST_CODE
		FROM G_POST G  LEFT JOIN LOC L
		ON G.LOC_CODE = L.LOC_CODE
		        LEFT JOIN G_PHOTO P
		ON G.G_POST_CODE = P.G_POST_CODE
		        JOIN G_CATE T
		ON G.G_CATE_CODE = T.G_CATE_CODE
		WHERE G_CATE_BCODE = 'G_CATE5'
		ORDER BY WDATE DESC
	</select>
	
	<!--대분류 카테고리 눌렀을 때 실시간 게시물  -->
	<select id="gCateMainList" resultType="com.banana.groupbuying.GPostDTO">
		SELECT *
		FROM  VIEW_CATEMAINLIST
		WHERE G_CATE_BCODE=  #{g_cate_bcode}
	</select>
	
	<!--중분류 카테고리 눌렀을 때 실시간 게시물  -->
	<select id="gCatemMainList" resultType="com.banana.groupbuying.GPostDTO">
		SELECT *
		FROM  VIEW_CATEMAINLIST
		WHERE G_CATE_BCODE = #{g_cate_bcode} AND G_CATE_MCODE = #{g_cate_code} 	
	</select>
	
	
	<!--상품 상세 게시물 불러오기  -->
	<select id="gPostDetailList" resultType="com.banana.groupbuying.GPostDTO">
		SELECT *
		FROM VIEW_GPOST
		WHERE G_POST_CODE = #{g_post_code}	
	</select>
	
	<!--신청 인원 불러오기  -->
	<select id="gApplyCount" resultType="int">
		SELECT COUNT(*)+1 AS COUNT
		FROM G_APPLY
		WHERE G_POST_CODE =#{g_post_code}
	</select>
	
	<!--나의 나눠사요 게시물 -->
	<select id="gMyList" resultType="com.banana.groupbuying.GPostDTO">
		SELECT *
		FROM VIEW_MYGROUPBUYING
		WHERE B_USER_CODE = #{b_user_code}
	</select>
	
	
</mapper>